version: 0.2

cache:
  paths:
    - node_modules/**/*

env:
  shell: bash
  secrets-manager:
    GITHUB_ACCESS_TOKEN: GITHUB_PERSONAL_ACCESS_TOKEN:value

phases:
    install:
      runtime-versions:
        nodejs: 16
      on-failure: ABORT
      commands:
        - |
          node scripts/deploy/install.js

batch:
  build-graph:
    - identifier: initial_build
    - identifier: home_page_build
      buildspec: buildspec.deploy.home.yml
      depend-on:
        - initial_build
    - identifier: about_page_build
      buildspec: buildspec.deploy.about.yml
      depend-on:
        - initial_build